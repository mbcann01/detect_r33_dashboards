{
  "hash": "f0983bde998e130a5463b6a6918b520c",
  "result": {
    "engine": "knitr",
    "markdown": "Total patients seen by clinicians: 8003\nTotal eligible appointments: 9121  \nTotal screened appointments: 5210\nTotal screened patients that will be contacted for recruitment: 4863\nTotal recruited patients that will be interviewed: 180\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'here' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nhere() starts at C:/Users/ebiek/OneDrive - UTHealth Houston/Cannell lab/r33_dashboards\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tidyr, include.only = c(\"separate_wider_delim\", \"crossing\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyr' was built under R version 4.3.2\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ids)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ids' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(randomNames)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'randomNames' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(lubridate, include.only = c(\"year\", \"month\", \"day\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.3.2\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(generator, include.only = \"r_phone_numbers\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'generator' was built under R version 4.3.3\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load function for converting POSIXct dates to a Month YYYY format.\nsource(here::here(\"r\", \"month_name_year.R\"))\n```\n:::\n\n\n# Clinician Screening Tracker Data\n## Unique MRNs and Dyad IDs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dyad IDs\nset.seed(123)\ndyad_id <- ids::random_id(8003, 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine MRNs and Dyad IDs\nmrn_dyad_ids <- data.frame(mrn, dyad_id, mrn_dyad_join = c(1:8003))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# MRN Dyad join column for full mock data\n\nset.seed(1)\nmrn_dyad_join_data <- sample(\n  c(1:8003, sample(c(1:8003), size = (13158 - 8003), replace = TRUE)))\n```\n:::\n\n\n## Visit dates\n\n\n\n\n## Physician and clinics\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Physician join column for full mock data\n\nset.seed(2)\nphys_join_data <- sample(\n  c(1:68, sample(c(1:68), size = (13158 - 68), replace = TRUE)))\n```\n:::\n\n\n\n## Screened assignments\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(23)\n# 2906 of all 5087 eligible patients are screened\nscreened_op <- sample(c(rep(1, 2001), sample(c(0,1), size = 11157, replace = TRUE)))\n```\n:::\n\n\n## Create full mock data set\n\n### Add ids, clinician data and appointment times\n\n\n\n\n\n### Add eligibility and screened status\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_eli_scr <- data_app %>% \n  group_by(mrn) %>%\n  arrange(visit_date) %>%\n  mutate(\n    visit_no = row_number(),\n    # Arbitrarily assign eligibility for alternating visits (odd vs even)\n    eligible = case_when(\n      visit_no %% 2 == 1  ~ 1,\n      visit_no %% 2 == 0  ~ 0\n    )\n  ) %>% \n  ungroup() %>%\n  mutate(\n    screened = case_when(\n      eligible == 1 ~ screened_op,\n      TRUE          ~ NA\n    )\n  )\n```\n:::\n\n\n\n### Add calculated values\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_com <- data_eli_scr %>%\n  mutate(\n    num_completed = case_when(\n      screened == 1 ~ sample(c(sample(c(0:12), 902, replace = TRUE), rep(12, (13158-902)))),\n      TRUE          ~ NA\n      ),\n    perc_completed = (num_completed/12)*100\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create date column with Month YYYY format.\ndata <- month_year(data_com, visit_date, \"month_year\") %>%\n  # Calculate proportion screened and proportion of screening questions answered \n  # each month for each clinic \n  group_by(month_year, clinic_name) %>%\n  mutate(\n    perc_screened_month_clinic = format(round((sum(screened, na.rm=TRUE)/sum(eligible, na.rm=TRUE))*100, digits = 2),nsmall=2),\n    perc_items_month_clinic = format(round(mean(perc_completed, na.rm=TRUE), digits = 2),nsmall=2)\n  ) %>%\n  ungroup() %>%\n  group_by(month_year, name_full_phys) %>%\n  # Calculate proportion screened and proportion of screening questions answered \n  # each month for each physician\n  mutate(\n    perc_screened_month_phys = format(round((sum(screened, na.rm=TRUE)/sum(eligible, na.rm=TRUE))*100, digits = 2),nsmall=2),\n    perc_items_month_phys = format(round(mean(perc_completed, na.rm=TRUE), digits = 2),nsmall=2)\n    ) %>%\n  ungroup() %>%\n  # Convert NaN to NA\n  mutate(\n    across(\n      .cols = c(starts_with(\"perc_items\"), starts_with(\"perc_screened\")),\n      .fns = ~ case_when(\n        .x == NaN ~ NA,\n        TRUE      ~ .x\n      )\n    )\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(data, here::here(\"data\", \"mock_data.rds\"))\n```\n:::\n",
    "supporting": [
      "mock_data_creation_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}